defmodule ScanTest do
  use ExUnit.Case
  doctest Scan

  describe "parse" do  
    test "parse string" do
      string = "    _  _     _  _  _  _  _ \n" <>
              "  | _| _||_||_ |_   ||_||_|\n" <>
              "  ||_  _|  | _||_|  ||_| _|"
      assert Scan.parse( string ) == ["123456789"]
    end

    test "parse multuple string" do
      string = "    _  _     _  _  _  _  _ \n" <>
               "  | _| _||_||_ |_   ||_||_|\n" <>
               "  ||_  _|  | _||_|  ||_| _|\n" <>
               "\n" <>
               " _  _  _  _  _  _  _  _  _ \n" <>
               "| || || || || || || || || |\n" <>
               "|_||_||_||_||_||_||_||_||_|\n" <>
               "\n" <>
               "                           \n" <>
               "  |  |  |  |  |  |  |  |  |\n" <>
               "  |  |  |  |  |  |  |  |  |\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              " _| _| _| _| _| _| _| _| _|\n" <>
              "|_ |_ |_ |_ |_ |_ |_ |_ |_ \n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              " _| _| _| _| _| _| _| _| _|\n" <>
              " _| _| _| _| _| _| _| _| _|\n" <>
              "\n" <>
              "                           \n" <>
              "|_||_||_||_||_||_||_||_||_|\n" <>
              "  |  |  |  |  |  |  |  |  |\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              "|_ |_ |_ |_ |_ |_ |_ |_ |_ \n" <>
              " _| _| _| _| _| _| _| _| _|\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              "|_ |_ |_ |_ |_ |_ |_ |_ |_ \n" <>
              "|_||_||_||_||_||_||_||_||_|\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              "  |  |  |  |  |  |  |  |  |\n" <>
              "  |  |  |  |  |  |  |  |  |\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              "|_||_||_||_||_||_||_||_||_|\n" <>
              "|_||_||_||_||_||_||_||_||_|\n" <>
              "\n" <>
              " _  _  _  _  _  _  _  _  _ \n" <>
              "|_||_||_||_||_||_||_||_||_|\n" <>
              " _| _| _| _| _| _| _| _| _|\n"

      assert Scan.parse( string ) == [ "123456789",
      "000000000",
      "111111111",
      "222222222",
      "333333333",
      "444444444",
      "555555555",
      "666666666",
      "777777777",
      "888888888",
      "999999999"]
    end

    test "raise when parsing wrong string" do
      string = "   ?_  _    |_| _  _  _  _ \n" <>
               "| | _| _<|_||_| |_   ||_||_|\n" <>
               "  ||_  _|| ||_||_|  ||_| _|"
      assert_raise ArgumentError, fn ->
        Scan.parse(string)
      end
    end

    test "parse string even whith lots of empty lines" do
      string = "\n\n\n"  <>
              "    _  _     _  _  _  _  _ \n" <>
              "  | _| _||_||_ |_   ||_||_|\n" <>
              "  ||_  _|  | _||_|  ||_| _|\n\n\n"
      assert Scan.parse( string ) == ["123456789"]
    end
  end
end

